# D3T2:中缀表达式转后缀表达式

## 1.内容和目的 

输入一个中缀表达式，编程输出其后缀表达式，要求输出的后缀表达式的运算次序与输入的中缀表达式的运算次序相一致。为简单起见，假设输入的中缀表达式由＋（加）、－（减）、×（乘）、／（除）四个运算符号以及左右圆括号和英文字母组成，其中算术运算符遵守先乘除后加减的运算规则。假设输入的中缀表达式长度不超过300个字符，且都是正确的，即没有语法错误，并且凡出现括号其内部一定有表达式，即内部至少有一个运算符号。

中缀表达式转后缀表达式的方法：

1. 遇到操作数：直接输出（添加到后缀表达式中）
2. 栈为空时，遇到运算符，直接入栈
3. 遇到左括号：将其入栈
4. 遇到右括号：执行出栈操作，并将出栈的元素输出，直到弹出栈的是左括号，括号不输出。
5. 遇到其他运算符：加减乘除：弹出所有优先级大于或者等于该运算符的栈顶元素，然后将该运算符入栈
6. 最终将栈中的元素依次出栈，输出。


## 2.分析与设计实现

按题意模拟即可，不过我们发现如果使输入被括号包裹，则可以去掉操作6以简化代码。

### 核心代码

```cpp
map<char,int> PRI={//操作符优先级
	{'+',1},
	{'-',1},
	{'*',2},
	{'/',2},	
};
struct solution{
	string str;
	void scan(){
		getline(cin,str);
		str="("+str+")";
	}
	stack<char> stc;
	void solve(){
		for (auto c:str){
			if (isalpha(c)) putchar(c);//字母直接输出
			else if (c=='(') stc.push(c);//左括号入栈
			else if (c==')') {
				while (stc.top()!='(')//右括号-出栈到左括号
					putchar(stc.top()),stc.pop();
				stc.pop();//左括号出栈
			}else{
				if (PRI.find(c)!=PRI.end())//是操作符 
					while (PRI.find(stc.top())!=PRI.end()&&
						PRI[c]<=PRI[stc.top()])//是操作符且优先级比当前操作符大
						putchar(stc.top()),stc.pop();//出栈
				stc.push(c);//当前操作符入栈
			}
		}
	} 
};
```

## 3.性能分析

显然$O(n)$

## 4.小结

深化了对栈和中、后缀表达式的理解。

